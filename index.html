<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Google Visualization API Sheet Viewer</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    #table_div {
      width: 100%;
      max-width: 100%;
    }
  </style>
</head>
<body>
  <h1>Google Sheet Data via Visualization API</h1>
  <div id="table_div"></div>

  <script>
    // Load the Visualization API and the table package.
    google.charts.load('current', {'packages':['table']});

    // Set a callback to run when the API is loaded.
    google.charts.setOnLoadCallback(drawTable);

    function drawTable() {
      // Your published Google Sheet ID and sheet name
      const sheetID = '1B7yr8DF6TcyGmSG5wCCumhUOIs8NLssym0A4XHGpYX8';
      const sheetName = 'Display';

      // The Google Visualization query URL
      const queryString = encodeURIComponent('SELECT * LIMIT 32');
      const query = new google.visualization.Query(
        `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}&tq=${queryString}`);

      // Send the query with a callback
      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      if (response.isError()) {
        document.getElementById('table_div').innerText =
          'Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage();
        return;
      }

      const data = response.getDataTable();

      const table = new google.visualization.Table(document.getElementById('table_div'));

      // Draw the table with paging and sorting enabled
      table.draw(data, {showRowNumber: true, width: '100%', height: '100%', page: 'enable', pageSize: 20});
    }

    // Optional: refresh the data every 30 seconds
    setInterval(drawTable, 2000);
  </script>
</body>
</html>

